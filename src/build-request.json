{
  "kind": "build_request",
  "title": "Add cash payment option with change calculation",
  "projectName": "Mini Market Manager",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add 'dinheiro' (cash) as a fourth payment method option in the backend PaymentMethod variant, alongside the existing pix, debito, and credito options",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-6"
        ]
      },
      "acceptanceCriteria": [
        "Backend PaymentMethod type includes a 'dinheiro' variant",
        "Cash payment method can be used when recording sales"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Update frontend payment method types and mappers to support 'cash' as a payment method, mapping it to/from the backend 'dinheiro' variant",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ]
      },
      "acceptanceCriteria": [
        "Frontend PaymentMethod type includes 'cash' option",
        "Mappers correctly convert between frontend 'cash' and backend 'dinheiro'",
        "Portuguese label 'Dinheiro' displays in the UI"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add cash payment option button to CheckoutPanel alongside PIX, Debit, and Credit payment method buttons",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ]
      },
      "acceptanceCriteria": [
        "Cash payment button appears in checkout panel",
        "Button is visually consistent with other payment method buttons",
        "Selecting cash enables the change calculation flow"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Implement change calculation interface that appears when cash payment is selected, with an input field for the amount tendered and automatic calculation and display of change due",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "com o c√°lculo de troco quando a pessoa for pagar em dinheiro"
        ]
      },
      "acceptanceCriteria": [
        "Input field accepts the cash amount tendered by customer",
        "Change amount is calculated as (tendered amount - cart total)",
        "Change is displayed in BRL currency format",
        "Validation prevents completing sale if tendered amount is less than total",
        "Change calculation updates in real-time as user types"
      ]
    },
    {
      "id": "REQ-5",
      "text": "Update cash register reporting to include cash payment method in the breakdown calculations alongside PIX, debit, and credit",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ]
      },
      "acceptanceCriteria": [
        "Cash register close panel displays cash payment totals separately",
        "Cash closing history shows cash payment amounts",
        "Payment method breakdown calculations include cash transactions"
      ]
    },
    {
      "id": "REQ-6",
      "text": "Update sales history display to show cash payment method and preserve the display for historical sales with other payment methods",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ]
      },
      "acceptanceCriteria": [
        "Sales paid with cash display 'Dinheiro' as payment method",
        "Sales history correctly shows all four payment methods"
      ]
    }
  ],
  "constraints": [
    "Do not modify the existing payment methods (pix, debito, credito)",
    "Maintain compatibility with existing sales data",
    "Use Portuguese language labels for payment methods in the UI"
  ],
  "nonGoals": [
    "Modifying the raffle eligibility calculation logic",
    "Changing the cash register opening/closing flow",
    "Adding other payment methods beyond cash"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}